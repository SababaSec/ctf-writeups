# Loopy #1

## Problem

> Same program as Loopy #0, but someone's turned on the stack protector now!<br>
Connect at `nc shell.2019.nactf.com 31732`

[loopy-1](loopy-1)

[loopy-1.c](loopy-1.c)

[libc.so.6](libc.so.6)

## Hints

> - You will need to call `printf` quite a few times<br>
> - What happens when the stack canary check fails?

## Solution

This challenge is similar to [Loopy #0](../Loopy%20%230), with the addition of a [stack canary](https://ctf101.org/binary-exploitation/stack-canaries/). If the program detects that the canary appears to be modified, a function called `__stack_chk_fail()` is called, which leads to the termination of the program. There are several ways to bypass stack canaries. The approach we use is to overwrite the value at `__stack_chk_fail()`'s GOT with the `ret` ROP gadget in order to render it useless.

[Python script](solver.py)
